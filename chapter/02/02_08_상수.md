# 고정된 값, 상수



![상수](../../images/02_08_main.png)


>“할 수 있을 때까지 계속해라. 그러면 할 수 있게 된다.” — 에픽테토스



상수는 한 번 값이 들어간 후 ‘타입이 고정된 봉인된 상자’ 라고 생각할 수 있다. '나무나 돌판 위에 새겨진 숫자' 라고 생각해도 좋다.(이해를 돕기 위해 상상력을 발휘해보자.) 즉 계속 값이 변할수 있는 변수와 달리, 상수는 한 번 정해지면 변하지 않는 값이나 데이터를 담기에 좋다. 상수를 사용하면, 코드 작성 중이나 실행 중에 “이 값이 바뀔까?”, “지금 여기에 무슨 값이 들어있지?” 등을 걱정할 필요가 없다. 정해진 값은 프로그램이 종료될 때까지 변하지 않는다. 즉 상수는 특별한 형태의 “고정된 값”을 의미하며, Dart에서는 final 키워드와 const 키워드 두 가지 방법을 통해 상수를 정의할 수 있다.

```dart
void main() {
  final name = '홍길동'; // 런타임 상수
  const age = 30; // 컴파일 타임 상수

  print(name); // 홍길동
  print(age);  // 30
}
```

한 번 상수로 정의된 name과 age의 값은 중간에 변경할 수 없다. 상수를 잘 활용하면, 값이 실수로 바뀌는 상황을 방지할 수 있고, 이는 코드의 안정성과 예측 가능성을 높이는 데 도움이 된다. 

그렇지만 정말 상수로 선언된 값은 절대로 바뀌지 않는 걸까? 직접 실험해 보자.

```dart
void main() {
  final name = '홍길동'; // final 은 한 번만 할당 가능 (런타임 상수)
  const age = 40; // const 는 컴파일 타임 상수라고 부른다.
  age = 20; //궁금하면 한번 변경해보자.
}
```
age = 20 으로 나이를 좀 낮춰보려 했지만, Dart가 에러메세지를 출력하며 단호하게 거절한다.

```dart
compileDDC
main.dart:8:3: Error: Can't assign to the const variable 'age'.
  age = 20;
  ^^^
```

실제로 테스트해보니, 상수로 정의된 값은 절대 변경할 수 없다는 것을 확인할 수 있다. Dart는 런타임 상수인 final, 그리고 컴파일 타임 상수인 const 두 가지 형태를 지원한다. 우선 final을 사용한 상수 정의 방법부터 살펴보자.


>**[팁&노트]**
**컴파일타임(Compile Time):**
우리가 작성한 코드를 컴퓨터가 이해할 수 있도록 번역하는 시점이다. 이 과정에서 문법적인 오류가 있으면 컴파일 에러가 발생한다.<br>
**런타임(Runtime):**
프로그램이 실제로 실행되는 시점이다. 실행 중 발생하는 오류는 런타임 에러라고 부르며, Dart에서 const는 컴파일타임에 값이 확정되어야 하고, final은 런타임에 값이 정해진다.



### final
런타임(실행시점) 상수인 final 키워드를 사용하면 한 번 값을 할당한 이후에는 다시 변경할 수 없다.

```dart
final String name = "홍길동";
name = "김길동"; //여기서 에러 발생 -> 재할당 불가능.
```

final과, String이라는 명확한 타입을 함께 작성하고, name에 다른 값을 다시 할당하려고 하면 오류가 발생한다. 한 번 정해진 값은 변경할 수 없기 때문이다.
물론 아래와 같이 타입을 생략한 형태로도 작성할 수 있다.

```dart
final name = '홍길동';
```

이 방법은 var를 사용할 때 타입을 생략하는 것과 비슷한 방식이다. 그럼 final과 var를 같이 사용하면 어떨까?

```dart
final var c = ""; // var과 상수키워드 final을 같이 쓸수 없다.
```

var 은 변수선언시 “타입추론”을 목적으로 만들어진 키워드이기 때문에, 상수값을 의미하는 final과는 함께 쓸 수 없다.

### const

이번에는 일명 컴파일타임 상수를 만드는 키워드인 const를 사용해 보자. 상수를 작성하는 방법은 크게 다르지 않다. final을 빼고 const를 사용해보자.

```dart
const String name = "홍길동"; // 명시적 타입 선언
const age = 30; // 타입 생략 가능
```


마찬가지로 const로 선언된 값은 컴파일 시점에 이미 값이 고정되기 때문에, 이후에 값을 변경하려고 하면 오류가 발생한다.

```dart
const age = 30;
age = 20; // 오류발생
```

### AI와 함께 학습하세요
>Q. dart의 상수에 대해서, const와 final을 언제 어떻게 사용해야 할까?

---

## 심화학습

### 컴파일 타임
우리가 작성하는 소스코드를 실행하기 위해서는 "컴파일" 이라고 하는 단계를 거치게 된다. 이는 우리가 사용하는 기계, 즉 컴퓨터가 알아 들을수 있도록 하는 일종의 번역 과정이다. 우리가 만든 소스코드(우리가 눈으로 보고 이해하며, 작성이 가능한 문법으로 이루어진 코드)는 중간단계(bytecode)로 만들어지거나, 기계가 이해할수 있는 네이티브 언어로 번역되는것이다. 

**"그럼 처음부터 기계어로 코딩하면 안되나요? 그렇게 되면 컴파일 과정도 필요없을텐데..."**

아래는 기계어(어셈블리어) 수준의 예시이다. 우리가 이 코드를 이용해 직접 프로그래밍해야 한다고 상상해 보면, 현대의 언어들에게 고마움을 느낄수 있다. 즉 우리는 기계어를 (잘)모르고, 기계도 역시 우리의 언어를 모른다. 따라서 번역이라는 작업이 필요한 것이다.

```dart
//기계어 예시
MOV AX, 000A   ; AX 레지스터에 10 저장
ADD AX, 0005   ; AX에 5를 더함
MOV BX, AX     ; 결과를 BX에 저장
```

>**[팁&노트]**
**어셈블리어로 만들어진 상용 게임**
1999년에 출시된 인기 경영 시뮬레이션 게임 'RollerCoaster Tycoon'은 대부분의 게임 엔진이 C++을 쓰던 시절에도 90% 이상이 x86 어셈블리어(Assembly)로 작성되었습니다. 개발자 크리스 소여는 성능 극대화를 위해 직접 어셈블리어를 선택했고, 이 덕분에 당시 기준으로 매우 정교한 시뮬레이션 로직과 놀라운 실행 속도를 구현해냈습니다. 이 사례는 “고급 언어 없이도 완성도 높은 대형 프로그램이 가능하다”는 걸 보여주는 역사적인 예시로 자주 언급됩니다.[^1]

결국 우리가 사용하는 언어(Dart 같은) 들은 아래의 흐름으로 변환되어 실행되게 된다.


>[사람] → [Dart 코드 작성] → ([바이트코드] →) [기계어] → [CPU]

### **런타임**
이제 다시 상수 이야기로 돌아가자. final은 런타임, 즉 우리가 작성한 코드가 실제로 실행되는 시점에 값이 확정되는 상수이다.

복합적으로 사용되는 예제를 살펴보자.

```dart
final title = '제목'; // 런타임 상수
const Text(title); // 오류 발생
```

위 예제는 겉보기에는 별 문제가 없어 보이지만, 위 코드는 실제로 오류가 발생한다. title은 final로 선언된 변수이기 때문에, 런타임 시점에 값이 확정되는 상수이다. 하지만 const는 컴파일 시점에 값이 완전히 결정되어 있어야 사용 가능한 키워드이기 때문에, const Text(title)와 같이 const 안에서 final 값을 사용하는 것은 허용되지 않는다.

따라서 const로 정의된 객체 안에서는 반드시 const로 선언된 값만을 사용할 수 있다. 이처럼 final과 const는 값이 확정되는 시점(실행전에 반드시 컴파일과정을 거친다)이 다르기 때문에, 목적에 따라 명확하게 구분하여 사용하는 습관이 중요합니다.

### **활용사례**
```dart
const pi = 3.141592;
const maxUserCount = 1000;
```

이처럼 항상 동일한 값이고 변하지 않는 고정된 의미를 가지는 데이터는 const로 선언하는 것이 적합하다. const는 컴파일 타임에 값이 확정되므로, 앱이 실행되기 전에 이미 정해져 있어야 하는 설정값, 물리 상수, 제한값 등에 유용하다.

```dart
final currentTime = DateTime.now();
final userId = getUserIdFromServer();
final total = expensiveCalculation(); // 계산은 실행 중 발생
```

반면 final은 런타임 중 한 번만 값을 설정할 수 있는 상수입니다. 위와 같이 현재 시각, 서버로부터 받아오는 사용자 정보, 실행 중 계산된 값처럼, 실행 시점에만 알 수 있는 데이터는 final을 사용하는것이 좋다.


### AI와 함께 학습하세요
>Q. 프로그래밍에서 컴파일시점과 런타임에 대해서 초보자를 위한 비유를 들어서 설명해줘.


---

## Copilot 활용 실습

이번에는 Dart의 final과 const 키워드를 직접 사용하여 차이를 느껴보는 실습을 해보려고 한다. 어떤 값이 런타임에 결정되어야 하고, 어떤 값은 컴파일 시점에 고정되어야 하는지 직접 코드를 작성하고, 결과를 확인해보자.


```dart
void main() {
  // 1) const로 선언된 상수
  // 컴파일 타임에 이미 값이 결정되어야 한다.
  const pi = ...;
  const maxUsers = ...;

  // 2) final로 선언된 상수
  // 실행 중 한 번만 할당 가능 (런타임 상수)
  final currentTime = ...; // 예: DateTime.now();
  final randomId = ...;    // 예: 사용자 입력, 서버 응답 등

  // 3) 출력해보자
  print('pi: $pi');
  print('maxUsers: $maxUsers');
  print('currentTime: $currentTime');
  print('randomId: $randomId');

  // 4) 오류를 유도해보자
  // 기존에 선언/할당된 상수에 값을 재할당하려고 시도해보자.
  // pi = 3.14;         // const는 재할당 불가
  // currentTime = DateTime.now(); // final도 재할당 불가
}
```

---

[^1] Wikipedia – RollerCoaster Tycoon (video game) https://en.wikipedia.org/wiki/RollerCoaster_Tycoon_(video_game)
