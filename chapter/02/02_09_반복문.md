# 반복되는 패턴

![반복문](../../images/02_09_반복문.png)


>“나는 실패하지 않았다. 단지 작동하지 않는 1만 가지 방법을 찾았을 뿐이다.” — 토머스 에디슨



만약 프로그래밍을 하다가 아래와 같은 출력문을 만들고 싶다면 어떻게 하면 될까?

```dart
0
1
2
3
4
5
...
```

그동안 배운 내용을 바탕으로 아래와 같이 작성할 수 있다.

```dart
print(0);
print(1);
print(2);
print(3);
print(4);
print(5);
```

이 코드는 문법적으로는 아무 문제가 없고, 실행도 잘 된다. 하지만 눈에 보이듯이, 같은 패턴을 단순 반복하고 있다는 점에서 매우 비효율적으로 보인다. 이럴 때 우리는 자연스럽게 생각해볼수 있다. “이걸 좀 더 간단하게 표현할 수는 없을까?” “한 줄로 줄일 수 있는 방법은 없을까?” 이런 고민이 바로 반복문(loop) 의 출발점이다.

## for 반복문

이처럼 반복되는 동작을 효율적으로 작성하고 싶을 때 사용하는 것이 바로 for문이다. 반복 횟수가 적다면, 앞서 살펴본 것처럼 print()를 여러 번 나열해도 큰 문제는 없을 수 있다. 하지만 앱이 점점 커지고, 코드가 복잡해지면서 만약 100번, 1000번 같은 반복이 필요하다면 어떨까? (물론 극단적인 예이다) 이런 코드를 일일이 작성하는 것은 비효율적이고 분석을 어렵게 만든다. 그래서 우리는 for문과 같은 반복문을 사용해 간결하고 유지보수하기 쉬운 코드를 작성해야 하는 것이다.

for문의 구조를 살펴보자. 초기값, 조건식, 증감처리 부분을 고려해서 작성하면된다.

```dart
for ([초기값]; [조건식]; [실행코드 이후 값 증감처리]) {
  // 실행될 코드
}
```

아래의 예제는 숫자 0부터 9까지를 출력하는 예제이다.

```dart
for(var i=0; i < 10; i++){
   print(i);
}
```

조금 복잡할수 있으니 부분 부분 하나씩 살펴보자.
- ***var i=0*** 은 말그대로 i 라는 변수에 0이라는 정수를 정의해줬다.(초기값지정)
- ***i < 10*** 이건 무슨뜻일까? 바로 반복이 행해지기 위한 조건이다. 즉 i에 담긴 값이 10보다 작을때만 실행코드를 진행하라는 뜻이다. 즉 [i < 10] 조건이 성립할때만 { } 괄호 안에 있는 print(i)가 실행되게 된다.
- ***i++*** 은 { }괄호안의 실행코드가 한번 실행될때 마다 +1씩 증가된다는 뜻이다. (증감처리)


이번에는 조금 응용을 해보자. 기본예제는 작은 숫자부터 큰 숫자로 순차적으로 출력했지만, 이번에는 큰 숫자부터 작은 숫자까지 거꾸로 출력해보자. 이럴 땐 초기값을 가장 큰 수로 설정하고, 조건과 증감식을 반대로 설정하면 된다. 예를 들어, 10부터 1까지 출력하고 싶다면 아래와 같이 작성할 수 있다.

```dart
for(var i=10; i > 0 ;i--){
   print(i);
}
```

이 코드의 구성은 다음과 같다.
- **var i = 10** → 시작값을 10으로 설정한다.
- **i > 0** → i가 1 이상일 때만 반복을 실행한다.
- **i--** → 한 번 실행될 때마다 i를 1씩 감소시킨다.

이처럼 for문의 구조는 초기값, 조건, 증감식만 바꾸면 다양한 방향으로 활용할 수 있습니다. 반복문은 하나의 틀일 뿐, 어떻게 활용할지는 여러분의 활용에 달려 있다. 또한 if 문처럼, for 문 역시 중첩해서 사용할 수 있다. 즉, 반복문 안에 또 다른 반복문을 넣는 것도 가능하며, 이를 중첩 for문(nested loop)이라고 부른다. 예를 들어, 바깥쪽에서 0부터 9까지 반복하면서, 그 안에서 또 한 번 0부터 9까지 반복하는 구조를 만들 수도 있다.

```dart
for(var i=0; i < 10 ;i++){ // 바깥쪽 반복문
   print(i);
   for(var n=0; n < 10 ;n++){ // 안쪽 반복문
		   print(n);
		   //...
		}
}
```

이런 구조는 단순하지만 2차원 배열, 그리드, 좌표 계산, 게임 개발 등에서 자주 사용 되기 때문에 되도록 많이 응용해보는게 좋다.

## **심화학습**
### **2차원배열**
가장 흔한 2차원 배열 형태의 활용이다. 2차원 배열은 열과 행 형태의 데이터를 의미한다. 일종의 표라고 생각하면 쉽다. 

아래의 예제는 3행 3열 형태의 2차원 배열 형태이다. 행 단위로 읽어서, 해당 열에 값을 출력하는 예제이다. 복잡해 보이지만 실제로 작성해보시면 이해하기 어렵지 않다.

```dart
void main() {
  var matrix = [ //일종의 표라고 상상해보자.
	//1열, 2열, 3열
    [1, 2, 3], //1행
    [4, 5, 6], //2행
    [7, 8, 9], //3행
  ];

  for (var i = 0; i < matrix.length; i++) { //행을 기준으로 반복한다.
    for (var j = 0; j < matrix[i].length; j++) { //열에 맞춰 표시한다. 
      print('matrix[$i][$j] = ${matrix[i][j]}');
    }
  }
}
```

이번에는 그리드의 기초 구조를 이해하기 좋은 예제이다. 게임보드, 퍼즐, 타일맵 등을 만들 때 이런 방식을 응용할수 있다. 중첩 for문으로 2차원 공간을 만들고, 조건문을 활용해 특정 위치에만 플레이어를 배치하는 형태이다.


**간단한 게임 맵 (특정 위치 표시)**

```dart
void main() {
  int playerX = 2; // 플레이어의 X 좌표
  int playerY = 1; // 플레이어의 Y 좌표

  for (var y = 0; y < 4; y++) { // 4행 반복
    var line = ''; // 해당 변수에 출력할 문자열을 저장한다.
    for (var x = 0; x < 4; x++) {// 4열 반복
      // 플레이어 위치에 따라 [P] 또는 빈 공간 [ ] 표시
      if (x == playerX && y == playerY) { // 플레이어 위치
        line += '[P]'; // Player 위치
      } else {
        line += '[ ]'; // 빈 공간
      }
    }
    print(line); // 완성된 한 줄 출력 ex) [ ][ ][ ][ ]
  }
}
```

**출력 결과**
```dart
[ ][ ][ ][ ]
[ ][ ][P][ ]
[ ][ ][ ][ ]
[ ][ ][ ][ ]
```



### **주의**
마찬가지로 과도한 반복문의 중첩은 코드를 읽을때 가독성이 굉장히 떨어지기 때문에 주의가 필요하다. 이 코드는 5중 중첩 for문이다. 총 반복 횟수는 3⁵ = 243번이고, 각 반복문은 내부 상태를 알기 어렵게 얽혀 있어 디버깅과 유지보수에 매우 불리하다. 이렇게 수많은 중첩은 앱의 성능을 심각하게 저하시킬뿐 아니라, 분석하기도 어렵게 만든다.

```dart
void main() {
  for (var i = 0; i < 3; i++) { // 5중 중첩 for문
    for (var j = 0; j < 3; j++) { // 나는 누구
      for (var k = 0; k < 3; k++) { // 여긴 어디
        for (var l = 0; l < 3; l++) { // 보기만 해도 머리가 아픈
          for (var m = 0; m < 3; m++) { // 이런코드는 지양하는 것이 좋다.
            print('i:$i j:$j k:$k l:$l m:$m');
          }
        }
      }
    }
  }
}
```

이처럼 과도하게 중첩된 반복문은 처음엔 단순하게 보일 수 있지만, 시간이 지나고 코드가 커질수록 구조를 파악하기 어렵고, 내부 변수들이 어떻게 변화하는지 추적하는 것도 매우 까다로워진다. 코드를 작성할때는 항상 가독성, 성능, 유지보수성을 함께 고려해야 한다.

### AI와 함께 학습하세요
> Q. dart의 중첩된 for문을 쉽게 리팩토링하는 방법이 있을까?


## 추가로 알아두세요!
### **for in 반복문**

for-in은 기본 for 문을 더 간단하고 직관적인 형태로 축약한 반복문이다. 특히 앞으로 배우게 될 리스트(List) 같은 컬렉션 형태의 데이터 구조를 순회할 때 자주 사용된다.

```dart
var fruits = ['사과','딸기','포도']; // 아직 배우지 않은 리스트(목록) 형태의 데이터
for(var f in fruits){ // for-in 반복문
  print(f);
}
```

위 예제를 풀어서 해석해보면, "fruits 라는 목록을 차례대로 순회하면서 사과 딸기 포도라는 아이템을 var f 변수에 담아줄께. 그 값을 이용해 실행 코드를 작성해.” 라는 뜻이다. 아직 리스트라는 자료형을 배우지 않았지만 이런 형태로 간단하게 반복문을 만들수 있구나 하고 알아 두도록 하자.

>[팁&노트]
'for-in' 반복문은 List뿐만 아니라, Set, Map과 같은 다양한 컬렉션 구조에도 사용할 수 있다. 각각의 요소를 하나씩 꺼내어 순회하기 때문에 코드가 간결해지고 가독성도 매우 좋아진다. 다양한 컬렉션타입을 다룰 때는 for-in을 적극 활용해보자.

## **forEach 반복문**
마지막으로 **for each** 라는 반복문 형태이다. 마찬가지로 리스트(목록) 형태의 데이터 구조가 있을때 사용할수 있다. 아래와 같이 사용하며 아직 함수 구조에 대해 배우지 않았기 때문에 이렇게도 사용할수 있구나 가볍게 이해하고 넘어 가도록 하자.

```dart
var fruits = ['사과','딸기','포도']; // 리스트 형태의 데이터
fruits.forEach((f){ // forEach 반복문
 print(f);
});

```

### AI와 함께 학습하세요
> Q. dart의 다양한 반복문 for, for in, For each 에 대해서 다양한 예제를 제공해줘.


## **while 문**

while 문은 영어로 “~동안” 이라는 의미를 가지며, 프로그래밍에서도 같은 개념으로 사용된다. while 문은 ()안에 조건이 참일 동안 중괄호 { } 안에 있는 코드 블록을 반복해서 실행한다. 특히 반복 횟수가 명확하지 않거나, 외부의 어떤 조건에 의해 반복 여부가 결정되는 경우에 자주 사용된다. 

```dart
int i = 0; // i가 0부터 시작해서 5이하일때까지 반복한다.
while (i < 5) { // i가 5이하인지 판단하고
  print(i); // i가 5이하일때만 실행코드를 진행한다.
  i++;// i가 4이상이 되면 while문을 탈출한다.
}
```

하나씩 살펴보자. int i = 0처럼 while 블록 외부(중괄호 바깥)에 선언된 변수 i는 반복이 진행되면서 조건에 따라 값이 계속 변화하는걸 볼수있다. 그리고 이 값이 특정 조건(i<5)을 만족하지 않게 되면, (예를 들어 i가 4 이상이 되는 순간) 조건식은 거짓(false)이 되어 while 문을 자동으로 탈출하게 되는것이다.

**무한루프를 주의하라**

주의해야 할 점은 while 문으로 아래와 같이 무한반복코드(의도한것이라도)를 작성하는 경우이다. 지금은 아마 “대체 그런코드가 왜 필요하지?” 라고 생각 하겠지만 수많은 조건들과 복합적인 상황을 구현하다보면 필요한 경우가 있다.

```dart
while(true){ // 조건이 언제나 "참" 이기 때문에... 끝없이 반복되는 코드가 생성된다. = 무한루프
	print('안녕하세요.');
}
```

이런 무한루프코드를 작성할때는 외부(while문 밖에) 어딘가에  true -> false 조건으로 바꾸는 코드가 반드시 있어야한다. 그렇지 않으면 프로그램상에서 예기치 못한 심각한 문제를 일으킬수 있기 때문이다. 예를 들면 아래와 같이 while문 외부에 조건을 두고, 특정 조건이 만족되면 무한루프를 종료하는 코드를 작성할 수 있다.

```dart
  bool keepRunning = true; //무한 루프의 조건은 while 코드블록 외부에 존재
  int count = 0;

  while (keepRunning) { //keepRunning 가 true(참) 인 동안에 실행코드가 무한 실행
    print('반복 횟수: $count');
    count++;

    if (count >= 5) {
      keepRunning = false; // 반드시 어딘가에서 조건을 false로 바꿔줘야 한다.
    }
  }
```


>**[팁&노트]**
while(true)처럼 종료 조건 없이 반복되는 무한 루프 코드를 잘못 사용하면, 앱이 계속 실행 상태에 머무르며 CPU를 과도하게 점유하거나 시스템 리소스를 소모하게 된다. 이로 인해 앱이 멈추지 않고 백그라운드에서 계속 살아있는, 일명 “좀비앱” 상태가 될 수 있기 때문에 주의가 필요하다.



### AI와 함께 학습하세요
> Q. 프로그래밍에서 while로 만든 무한루프를 왜 조심해야 하는지 여러가지 문제상황들을 예시로 알려줘.

---

## Copilot 활용 실습

우리는 계단을 올라가며 운동을 시작하려고 한다. 1층부터 10층까지 올라가면서 "현재 N층입니다!"라고 외치는(출력) 코드를 작성해보자. for문 적극적으로 활용해 반복 작업을 처리하고, 자유롭게 수정해보자.

```dart
//1층부터 10층까지 올라가기
main(){
  //1) for문을 사용해 1부터 10까지 반복한다. (1층부터 10층까지)
  for(int floor = 1; floor <= 10; floor++){
    //print('현재 N층입니다!');
  }

  // 올라갔으면, 다시 내려와야 한다.
  //2) for문을 사용해 10부터 1까지 반복한다.
  //...

  // 내려왔으면, 다시 올라가야 한다. (무한루프를 조심하라!)
  //3) while문을 사용해 1부터 10까지 반복
  var isRunning = true; // 무한루프를 제어하는 변수
  // var floor = 1; // 현재 층을 저장하는 변수
  while (isRunning) {

    // 현재 층을 출력하는 코드
    //print('현재 N층입니다!');

    // 무한루프를 종료하는 조건을 추가해보자.
    // if 문을 사용해 특정 층에 도달했을 때 isRunning = false; 처럼 작성하고, 결과를 확인한다.
    // if (/* 특정 조건 */) {
    //   isRunning = false; // 무한루프를 종료한다.
    // }
  }
}
```

